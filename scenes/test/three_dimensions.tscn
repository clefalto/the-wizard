[gd_scene load_steps=34 format=3 uid="uid://c8pwwbq8gcys"]

[ext_resource type="Script" uid="uid://bo5cehnr8ouoj" path="res://scenes/test/three_dimensions.gd" id="1_dykvc"]
[ext_resource type="Script" uid="uid://0nujdwd05ef3" path="res://scenes/flipper/flipper_3d.gd" id="1_xo0s0"]
[ext_resource type="Script" uid="uid://cmrwu7vq5tbq1" path="res://scenes/ball/ball_manager.gd" id="3_3532u"]
[ext_resource type="PackedScene" uid="uid://cr6xgkw4k1b38" path="res://scenes/ball/ball.tscn" id="3_47141"]
[ext_resource type="Script" uid="uid://bxbo0ve3uqxv6" path="res://scenes/mechanics/ball_reset_area.gd" id="4_bj65e"]
[ext_resource type="PackedScene" uid="uid://qc0vw3w573tk" path="res://scenes/Components/Slot/component_slot.tscn" id="5_tyqpo"]
[ext_resource type="Script" uid="uid://bdmvsim6clm80" path="res://scenes/plunger/plunger.gd" id="6_187xg"]
[ext_resource type="Script" uid="uid://bm5jeacxkfxc1" path="res://scenes/plunger/ball_chute.gd" id="6_vknm6"]

[sub_resource type="BoxMesh" id="BoxMesh_187xg"]
size = Vector3(0.82, 0.25, 0.25)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_3532u"]
albedo_color = Color(0.345098, 0.32549, 1, 1)
rim = 0.85
rim_tint = 0.47

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_187xg"]
points = PackedVector3Array(-0.39576, -0.125, -0.125, 0.404397, 0.125, 0.125, 0.39576, 0.122302, -0.125, -0.404397, 0.125, 0.125, 0.39576, -0.125, 0.122302, 0.39576, -0.125, -0.125, -0.39576, 0.122302, -0.125, -0.39576, -0.125, 0.122302)

[sub_resource type="BoxMesh" id="BoxMesh_avw3x"]
size = Vector3(7.5, 0.25, 5)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_tyqpo"]
albedo_color = Color(0.47, 0.3337, 0.335972, 1)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_7tnmc"]
friction = 0.1

[sub_resource type="BoxShape3D" id="BoxShape3D_xo0s0"]
size = Vector3(7.5, 0.25, 5)

[sub_resource type="BoxMesh" id="BoxMesh_j57ll"]
size = Vector3(0.25, 0.25, 0.75)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_nemko"]
points = PackedVector3Array(-0.125, -0.125, -0.363565, 0.125, 0.125, 0.363565, 0.125, -0.125, 0.363565, 0.125, 0.125, -0.363565, -0.125, 0.125, 0.363565, -0.125, -0.125, 0.363565, 0.125, -0.125, -0.363565, -0.125, 0.125, -0.363565)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_xo0s0"]
friction = 0.0
bounce = 1.0

[sub_resource type="BoxShape3D" id="BoxShape3D_62fbj"]
size = Vector3(7.73511, 2, 0.148438)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_62fbj"]
friction = 0.0
bounce = 1.0

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_vknm6"]
bounce = 0.5

[sub_resource type="BoxShape3D" id="BoxShape3D_0lgrw"]
size = Vector3(0.526611, 1, 0.0886841)

[sub_resource type="BoxShape3D" id="BoxShape3D_r4lpw"]
size = Vector3(0.498505, 0.443848, 0.0350037)

[sub_resource type="BoxMesh" id="BoxMesh_3532u"]
size = Vector3(0.5, 0.25, 0.5)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_vknm6"]
points = PackedVector3Array(0.238576, 0.125, 0.238576, -0.246272, -0.125, -0.246272, -0.246272, -0.125, 0.246272, 0.246272, -0.125, -0.246272, -0.238576, 0.125, -0.238576, 0.246272, -0.125, 0.246272, -0.238576, 0.125, 0.238576, 0.238576, 0.125, -0.238576)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_pkgf5"]
friction = 0.0
bounce = 1.0

[sub_resource type="BoxShape3D" id="BoxShape3D_pkgf5"]
size = Vector3(0.197601, 2, 5.35083)

[sub_resource type="BoxShape3D" id="BoxShape3D_tyqpo"]
size = Vector3(0.761719, 1, 5)

[sub_resource type="BoxMesh" id="BoxMesh_tyqpo"]
size = Vector3(0.37, 0.2, 2.02)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_tyqpo"]
bounce = 0.5

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_tyqpo"]
points = PackedVector3Array(-0.201032, -0.115988, -1.02603, 0.215794, 0.108369, 1.02603, 0.215794, -0.115988, 1.02603, 0.215794, 0.108369, -1.02603, -0.185, 0.0997397, 0.947106, 0.215794, -0.115988, -1.02603, -0.201032, -0.115988, 1.02603, -0.185, 0.0997397, -0.947106)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_187xg"]
bounce = 0.5

[sub_resource type="Environment" id="Environment_avw3x"]
ambient_light_color = Color(1, 1, 1, 1)
ambient_light_energy = 1.16

[node name="Board" type="Node3D" node_paths=PackedStringArray("ball_spawn_point", "plunger")]
script = ExtResource("1_dykvc")
ball_prefab = ExtResource("3_47141")
ball_spawn_point = NodePath("BallSpawnPoint")
plunger = NodePath("Plunger")

[node name="BallManager" type="Node" parent="." node_paths=PackedStringArray("ball_drain", "ball_plunger") groups=["BallManager"]]
script = ExtResource("3_3532u")
ball_drain = NodePath("../Playfield/BallDrain")
ball_plunger = NodePath("../Plunger")

[node name="BallCount" type="Label3D" parent="BallManager"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.03962, 0, -3.23942)
pixel_size = 0.01
billboard = 1
text = "balls:"

[node name="Plunger" type="Node3D" parent="." node_paths=PackedStringArray("ball_spawn_point")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.43596, 0, -2.94411)
script = ExtResource("6_187xg")
ball_spawn_point = NodePath("../BallSpawnPoint")
ball_scene = ExtResource("3_47141")
plunge_force = 10.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="Plunger"]
mesh = SubResource("BoxMesh_187xg")
surface_material_override/0 = SubResource("StandardMaterial3D_3532u")

[node name="Area3D" type="Area3D" parent="Plunger"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Plunger/Area3D"]
shape = SubResource("ConvexPolygonShape3D_187xg")

[node name="Label3D" type="Label3D" parent="Plunger"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.33426, 0)
billboard = 1
text = "plunge"

[node name="BallSpawnPoint" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.51867, 0.411518, -2.96338)

[node name="Playfield" type="Node3D" parent="."]

[node name="BaseBoard" type="MeshInstance3D" parent="Playfield"]
mesh = SubResource("BoxMesh_avw3x")
skeleton = NodePath("")
surface_material_override/0 = SubResource("StandardMaterial3D_tyqpo")

[node name="StaticBody3D" type="StaticBody3D" parent="Playfield/BaseBoard"]
collision_mask = 4
input_ray_pickable = false
physics_material_override = SubResource("PhysicsMaterial_7tnmc")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/BaseBoard/StaticBody3D"]
shape = SubResource("BoxShape3D_xo0s0")

[node name="LeftFlipper" type="Node3D" parent="Playfield"]
transform = Transform3D(0.746499, 0, -0.665386, 0, 1, 0, 0.665386, 0, 0.746499, 2.44241, 0.263013, 0.952634)
script = ExtResource("1_xo0s0")
activation_action = "flip_left"
flip_speed = 750.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="Playfield/LeftFlipper"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.392283)
mesh = SubResource("BoxMesh_j57ll")

[node name="CharacterBody3D" type="CharacterBody3D" parent="Playfield/LeftFlipper"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.392283)
collision_layer = 2
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/LeftFlipper/CharacterBody3D"]
shape = SubResource("ConvexPolygonShape3D_nemko")

[node name="RightFlipper" type="Node3D" parent="Playfield"]
transform = Transform3D(-0.738396, 0, -0.674367, -7.45058e-09, 1, 0, 0.674367, 0, -0.738396, 2.46675, 0.263013, -0.958168)
script = ExtResource("1_xo0s0")
activation_action = "flip_right"
flip_speed = 750.0
flip_side = 1

[node name="MeshInstance3D" type="MeshInstance3D" parent="Playfield/RightFlipper"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.392283)
mesh = SubResource("BoxMesh_j57ll")

[node name="CharacterBody3D" type="CharacterBody3D" parent="Playfield/RightFlipper"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.392283)
collision_layer = 2
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/RightFlipper/CharacterBody3D"]
shape = SubResource("ConvexPolygonShape3D_nemko")

[node name="LeftWall" type="StaticBody3D" parent="Playfield"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 3)
collision_mask = 4
input_ray_pickable = false
physics_material_override = SubResource("PhysicsMaterial_xo0s0")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/LeftWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, -0.425781)
shape = SubResource("BoxShape3D_62fbj")

[node name="RightWall" type="StaticBody3D" parent="Playfield"]
transform = Transform3D(1, -7.45058e-09, 0, 0, 1, 0, 0, -4.95751e-09, 1, 0, 0, -2.14715)
collision_mask = 4
input_ray_pickable = false
physics_material_override = SubResource("PhysicsMaterial_62fbj")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/RightWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.632446, 0.5, -0.425781)
shape = SubResource("BoxShape3D_62fbj")

[node name="BallChute" type="Node3D" parent="Playfield"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.45156, 0.616541, -2.38358)
script = ExtResource("6_vknm6")

[node name="BallChuteWall" type="StaticBody3D" parent="Playfield/BallChute"]
collision_mask = 4
input_ray_pickable = false
physics_material_override = SubResource("PhysicsMaterial_vknm6")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/BallChute/BallChuteWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0318604, 0, -0.154205)
shape = SubResource("BoxShape3D_0lgrw")
debug_color = Color(0.639216, 0.6, 0.701961, 0.419608)

[node name="BallChuteOneWayArea" type="Area3D" parent="Playfield/BallChute"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.416378)
collision_mask = 4
input_ray_pickable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/BallChute/BallChuteOneWayArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0257111, -0.278076, 0.181595)
shape = SubResource("BoxShape3D_r4lpw")
debug_color = Color(0, 0.6, 0.156863, 0.419608)

[node name="BallChute" type="MeshInstance3D" parent="Playfield/BallChute"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0401921, -0.616541, -0.369199)
mesh = SubResource("BoxMesh_3532u")
skeleton = NodePath("../../..")

[node name="StaticBody3D" type="StaticBody3D" parent="Playfield/BallChute/BallChute"]
collision_mask = 4
input_ray_pickable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/BallChute/BallChute/StaticBody3D"]
shape = SubResource("ConvexPolygonShape3D_vknm6")

[node name="TopWall" type="StaticBody3D" parent="Playfield"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 0, 0)
collision_mask = 4
input_ray_pickable = false
physics_material_override = SubResource("PhysicsMaterial_pkgf5")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/TopWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.150894, 0.5, -0.108765)
shape = SubResource("BoxShape3D_pkgf5")

[node name="BallDrain" type="Area3D" parent="Playfield"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0, 0)
collision_layer = 0
collision_mask = 4
input_ray_pickable = false
script = ExtResource("4_bj65e")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/BallDrain"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.119141, 0, 0)
shape = SubResource("BoxShape3D_tyqpo")

[node name="ComponentManager" type="Node3D" parent="Playfield"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.199278, 0)

[node name="ComponentSlot" parent="Playfield/ComponentManager" instance=ExtResource("5_tyqpo")]

[node name="ComponentSlot2" parent="Playfield/ComponentManager" instance=ExtResource("5_tyqpo")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1.03682)

[node name="ComponentSlot3" parent="Playfield/ComponentManager" instance=ExtResource("5_tyqpo")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1.12091)

[node name="LowerObstacleLeft" type="MeshInstance3D" parent="Playfield"]
transform = Transform3D(0.756436, 0, -0.654068, 0, 1, 0, 0.654068, 0, 0.756436, 1.6976, 0.237611, 1.79273)
mesh = SubResource("BoxMesh_tyqpo")

[node name="StaticBody3D" type="StaticBody3D" parent="Playfield/LowerObstacleLeft"]
collision_mask = 4
input_ray_pickable = false
physics_material_override = SubResource("PhysicsMaterial_tyqpo")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/LowerObstacleLeft/StaticBody3D"]
shape = SubResource("ConvexPolygonShape3D_tyqpo")

[node name="LowerObstacleRight" type="MeshInstance3D" parent="Playfield"]
transform = Transform3D(-0.723919, 0, -0.689885, 0, 1, 0, 0.689885, 0, -0.723919, 1.704, 0.22689, -1.79354)
mesh = SubResource("BoxMesh_tyqpo")
skeleton = NodePath("../LowerObstacleLeft")

[node name="StaticBody3D" type="StaticBody3D" parent="Playfield/LowerObstacleRight"]
collision_mask = 4
input_ray_pickable = false
physics_material_override = SubResource("PhysicsMaterial_187xg")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Playfield/LowerObstacleRight/StaticBody3D"]
shape = SubResource("ConvexPolygonShape3D_tyqpo")

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.14281, 0)
light_energy = 5.087
light_indirect_energy = 1.97
omni_range = 10.2

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_avw3x")

[connection signal="input_event" from="Plunger/Area3D" to="Plunger" method="_on_area_3d_input_event"]
[connection signal="mouse_entered" from="Plunger/Area3D" to="Plunger" method="_on_area_3d_mouse_entered"]
[connection signal="mouse_exited" from="Plunger/Area3D" to="Plunger" method="_on_area_3d_mouse_exited"]
[connection signal="body_entered" from="Playfield/BallChute/BallChuteOneWayArea" to="Playfield/BallChute" method="_on_ball_chute_one_way_area_body_entered"]
[connection signal="body_exited" from="Playfield/BallChute/BallChuteOneWayArea" to="Playfield/BallChute" method="_on_ball_chute_one_way_area_body_exited"]
[connection signal="body_entered" from="Playfield/BallDrain" to="Playfield/BallDrain" method="_on_body_entered"]
